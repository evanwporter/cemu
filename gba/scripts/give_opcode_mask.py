def to_casez(value, mask):
    value = value.replace("_", "")
    mask = mask.replace("_", "")
    assert len(value) == len(mask)
    bits = "".join(v if m == "1" else "?" for v, m in zip(value, mask))
    return "_".join(bits[i : i + 4] for i in range(0, len(bits), 4))


stuff = [
    (
        "0000_0001_0010_1111_1111_1111_0001_0000",
        "0000_1111_1111_1111_1111_1111_1111_0000",
    ),
    (
        "0000_1000_0000_0000_0000_0000_0000_0000",
        "0000_1110_0000_0000_0000_0000_0000_0000",
    ),
    (
        "0000_1010_0000_0000_0000_0000_0000_0000",
        "0000_1111_0000_0000_0000_0000_0000_0000",
    ),
    (
        "0000_1011_0000_0000_0000_0000_0000_0000",
        "0000_1111_0000_0000_0000_0000_0000_0000",
    ),
    (
        "0000_1111_0000_0000_0000_0000_0000_0000",
        "0000_1111_0000_0000_0000_0000_0000_0000",
    ),
    (
        "0000_0110_0000_0000_0000_0000_0001_0000",
        "0000_1110_0000_0000_0000_0000_0001_0000",
    ),
    (
        "0000_0001_0000_0000_0000_0000_1001_0000",
        "0000_1111_1000_0000_0000_1111_1111_0000",
    ),
    (
        "0000_0000_0000_0000_0000_0000_1001_0000",
        "0000_1111_1000_0000_0000_0000_1111_0000",
    ),
    (
        "0000_0000_1000_0000_0000_0000_1001_0000",
        "0000_1111_1000_0000_0000_0000_1111_0000",
    ),
    (
        "0000_0000_0000_0000_0000_0000_1001_0000",
        "0000_1110_0100_0000_0000_1111_1001_0000",
    ),
    (
        "0000_0000_0100_0000_0000_0000_1001_0000",
        "0000_1110_0100_0000_0000_0000_1001_0000",
    ),
    (
        "0000_0001_0000_1111_0000_0000_0000_0000",
        "0000_1111_1011_1111_0000_0000_0000_0000",
    ),
    (
        "0000_0001_0010_0000_1111_0000_0000_0000",
        "0000_1101_1011_0000_1111_0000_0000_0000",
    ),
    (
        "0000_0000_0000_0000_0000_0000_0000_0000",
        "0000_1100_0000_0000_0000_0000_0000_0000",
    ),
]

for value, mask in stuff:
    print(to_casez(value, mask))
